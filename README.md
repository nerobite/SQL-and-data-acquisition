# SQL-and-data-acquisition
Загрузил все домашки по курсу, финальный проект второй версии доработанный и добавлены дополнительные задания с другого потока, которых в моем потоке не было. 

Учебный SQL проект по базе данных бронирования авиабилетов.
Цель проекта - дать описание базы данных и написать SQL запросы на извлечение данных, отвечающие на поставленные вопросы. 

Проектная работа по модулю “**SQL и получение данных**” образовательной онлайн-платформы "Нетология"

_Цель проекта_ - _дать описание **[базе данных](https://edu.postgrespro.ru/bookings.pdf)** и создать запросы, позволяющие ответить на следующие вопросы:_ 

1. Выведите название самолетов, которые имеют менее 50 посадочных мест?
2. Выведите процентное изменение ежемесячной суммы бронирования билетов, округленной до сотых.
3. Выведите названия самолетов не имеющих бизнес - класс. Решение должно быть через функцию array_agg.
4. Вывести накопительный итог количества мест в самолетах по каждому аэропорту на каждый день, учитывая только те самолеты, которые летали пустыми и только те дни, где из одного аэропорта таких самолетов вылетало более одного. В результате должны быть код аэропорта, дата вылета, количество пустых мест и накопительный итог.
5. Найдите процентное соотношение перелетов по маршрутам от общего количества перелетов. Выведите в результат названия аэропортов и процентное отношение. Решение должно быть через оконную функцию.
6. Выведите количество пассажиров по каждому коду сотового оператора, если учесть, что код оператора - это три символа после +7
7. Классифицируйте финансовые обороты (сумма стоимости билетов) по маршрутам:
До 50 млн - low
От 50 млн включительно до 150 млн - middle
От 150 млн включительно - high 
Выведите в результат количество маршрутов в каждом полученном классе. 
8. Вычислите медиану стоимости билетов, медиану стоимости бронирования и отношение медианы бронирования к медиане стоимости билетов, округленной до сотых.
9. Найдите значение минимальной стоимости полета 1 км для пассажира. То есть нужно найти расстояние между аэропортами и с учетом стоимости билетов получить искомый результат.
Для поиска расстояния между двумя точка на поверхности Земли нужно использовать дополнительный модуль earthdistance.

При выполнении задания учитывать следующие параметры:
Рейс, перелет - это flight_id, разовый перелет между двумя аэропортами
Маршрут - это все перелеты между двумя аэропортами.

**ER-диаграмма** 
![image](https://user-images.githubusercontent.com/130888872/233821774-bc9a48c5-fd7d-4fb0-a236-ddf5a35a3d48.png)

Подробная информация по проекту и сами **[запросы можно скачать и посмотреть здесь](https://github.com/batio3/SQL-and-data-acquisition/blob/main/project_final.sql)**.

Восстановить базу из *.backup файла можно по [ссылке](https://drive.google.com/file/d/1U15gYuu_ZFE2sQMN32GXK3phBLcUl6OM/view?usp=sharing)

В проекте созданы запросы на извлечение данных (SELECT) с  использованием фильтрации, группировки, сортировки, соединений, CTE и оконных функций.
